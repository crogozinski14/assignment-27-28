[
  {
    "objectID": "Assignment27_28.html",
    "href": "Assignment27_28.html",
    "title": "Assignment27_28",
    "section": "",
    "text": "Step 1\n\nlibrary(sf)\n\nWarning: package 'sf' was built under R version 4.4.3\n\n\nLinking to GEOS 3.13.0, GDAL 3.10.1, PROJ 9.5.1; sf_use_s2() is TRUE\n\nlibrary(osmdata)\n\nWarning: package 'osmdata' was built under R version 4.4.3\n\n\nData (c) OpenStreetMap contributors, ODbL 1.0. https://www.openstreetmap.org/copyright\n\nlibrary(dplyr)\n\nWarning: package 'dplyr' was built under R version 4.4.3\n\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\nlibrary(terra)\n\nWarning: package 'terra' was built under R version 4.4.3\n\n\nterra 1.8.42\n\nlibrary(ggplot2)\n\nWarning: package 'ggplot2' was built under R version 4.4.3\n\nfc &lt;- opq(\"Fort Collins, Colorado\") |&gt;\n  add_osm_feature(\"boundary\", \"administrative\") |&gt;\n  add_osm_feature(\"name\", \"Fort Collins\") |&gt;\n  osmdata_sf()\n\nfc &lt;- fc$osm_multipolygons |&gt; filter(name == \"Fort Collins\")\n\n\nfoco_rivers &lt;- opq(st_bbox(st_transform(fc, 4326))) |&gt;\n  add_osm_feature(\"waterway\") |&gt;\n  osmdata_sf()\n\n\n\nStep 2\n\npoudre_river &lt;- foco_rivers$osm_lines |&gt; \n  filter(grepl(\"Cache la Poudre\", name, ignore.case = TRUE))\n\npoudre_merged &lt;- st_union(poudre_river)\npoudre_river_sf &lt;- st_sf(geometry = poudre_merged)\n\n\n\nStep 3\n\nriver_length &lt;- st_length(poudre_river_sf)\nriver_length\n\n218184.6 [m]\n\n\n\n\nStep 4\n\npoudre_pts &lt;- st_cast(poudre_river_sf, \"POINT\")\n\n\n\nStep 5\n\ndem &lt;- rast(\"https://raw.githubusercontent.com/mikejohnson51/csu-ess-330/refs/heads/main/resources/foco-elev-cm.tif\")\n\n\n\nStep 6\n\nst_crs(poudre_pts) &lt;- 4326\npoudre_pts_proj &lt;- st_transform(poudre_pts, crs(dem))\n\n\npoudre_pts_vect &lt;- vect(poudre_pts_proj)\nelevation_values &lt;- extract(dem, poudre_pts_vect)\n\n\n\nStep 7\n\npoudre_pts_elev &lt;- bind_cols(poudre_pts_proj, elevation = elevation_values[, 2])\n\n\n\nStep 8\n\npoudre_pts_elev &lt;- poudre_pts_elev |&gt; mutate(ID = 1:n())\n\n\n\nStep 9\n\nstart_pt &lt;- poudre_pts_elev[1, ]\nend_pt &lt;- poudre_pts_elev[nrow(poudre_pts_elev), ]\nstraight_distance &lt;- st_distance(start_pt, end_pt)\nstraight_distance\n\nUnits: [m]\n         [,1]\n[1,] 6331.826\n\n\n\n\nStep 10\n\ninlet &lt;- head(st_cast(poudre_river_sf, \"POINT\"), 1)\noutlet &lt;- tail(st_cast(poudre_river_sf, \"POINT\"), 1)\npts &lt;- bind_rows(inlet, outlet)\nline &lt;- st_cast(st_union(pts), \"LINESTRING\")\n\n\nsin &lt;- st_length(poudre_river_sf) / st_length(line)\nsin\n\n34.56166 [1]\n\n\n\n\nStep 11\n\nelev_inlet &lt;- poudre_pts_elev$elevation[1]      \nelev_outlet &lt;- poudre_pts_elev$elevation[nrow(poudre_pts_elev)]  \n\n\nelev_change_m &lt;- (elev_inlet - elev_outlet) / 100  \n\n\nslope &lt;- elev_change_m / as.numeric(st_length(poudre_river_sf))\nslope\n\n[1] -0.0001267275\n\n\n\n\nStep 12\n\nlibrary(zoo)\n\n\nAttaching package: 'zoo'\n\n\nThe following object is masked from 'package:terra':\n\n    time&lt;-\n\n\nThe following objects are masked from 'package:base':\n\n    as.Date, as.Date.numeric\n\nprofile &lt;- extract(dem, poudre_river_sf)$dem\n\nWarning: [extract] transforming vector data to the CRS of the raster\n\nplot(profile, type = \"l\", col = \"gray\", main = \"River Elevation Profile\",\n     ylab = \"Elevation (cm)\", xlab = \"Index\", yaxt = \"n\")\n\n\ny_ticks &lt;- seq(floor(min(profile, na.rm = TRUE)/100)*100, ceiling(max(profile, na.rm = TRUE)/100)*100, by = 200)\naxis(2, at = y_ticks, las = 2)  \n\n\nlines(rollmean(profile, k = 10, na.pad = TRUE), col = \"darkred\", lwd = 3)"
  }
]